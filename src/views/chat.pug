doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    script(src="/socket.io/socket.io.js")
    link(rel="stylesheet" href="/static/styles/tailwind.min.css")
    link(rel="stylesheet" href="/static/styles/shared.css")
    link(rel="stylesheet" href="/static/styles/chat.css")
    link(rel="stylesheet" href="/static/styles/root.css")
  body
    .flex.min-h-screen
      aside(class="w-64 bg-gray-800 p-4")
        nav(class="flex flex-col space-y-2")
          a(href="/chat" class="font-bold text-blue-400 hover:underline") New Chat 
          hr(class="my-2 border-gray-600")
          each chat in chats 
            a(
              href=`/chat/${chat.id}`,
              target="main",
              class="text-gray-300 hover:text-white truncate"
            ) #{chat.title || 'Untitled Chat'}
      if chat == undefined
        - chat = { messages: [] }
      main
        section#chat
          #chatMessages
            each message in chat.messages 
              .message-wrapper
                if (message.role === 'user')
                  .user-message
                    p.message--role #{message.role}
                    p.message--content= message.content
                else
                  .ai-message
                    p.message--role #{message.role}
                    p.message--content= message.content
        if chat.id 
          - formAction = "/chat/" + chat.id
        else 
          - formAction = "/chat"
        section
          form#chatForm(
            method="post",
            data-chat-id=chat.id || ''
          )
            if chat
              input(type="hidden" name="chat_id" value=chat.id)
            textarea#messageInput(
              name="message",
              placeholder="Type your messageâ€¦",
              required=true,
              autocomplete="off",
            )
    script(src="/static/scripts/chat.js")
